# -*- coding: utf-8 -*-
"""final_data_preprocessing.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1gBZUjzk2IuKW2GgMROqcWAsO33NlDiWu
"""

!gdown --id 1WQki6G0bvmpfQ7xpX7W2_XpIoXrEM10y

import numpy as np
import pandas as pd

def clean_dataset(df):
    assert isinstance(df, pd.DataFrame), "df needs to be a pd.DataFrame"
    df.dropna(inplace=True)
    indices_to_keep = ~df.isin([np.nan, np.inf, -np.inf]).any(1)
    return df[indices_to_keep]

def y_labels(data):
    dict={'Adware':0,'Banker':1 , 'FileInfector':2,'PUA':3,'Riskware':4,'SMS':5,'Trojan':6,'Backdoor':7,'Dropper':8,'NoCategory':9,'Ransomware':10, 'Scareware':11 ,'Spy':12 ,'Zeroday':13,'Benign':14}
    for key, value in dict.items():
      data[data[9505]==key]=value
    return data

def reduce_size_float(data):
  for col in data.columns:
    data[col] = data[col].astype(np.float16)
  return data

def reduce_size_int(data):
  for col in data.columns:
    data[col] = data[col].astype(np.uint8)
  return data

best_features=[]
myFile = open("best_features.txt", "r")
for myLine in myFile:
  try:
    best_features.append(int(myLine))
  except:
    continue

best_features

len(best_features)

best_features.sort()

best_features

best_features.remove(9501)

best_features.remove(9502)

if __name__ == "__main__":    
    
   
    float_cols=[9501,9502]

    X_Data=pd.read_csv("/content/output.csv",header=None,dtype=np.uint16,usecols=best_features)
    print(1)
    data_2=pd.read_csv("/content/output.csv",header=None,usecols=float_cols)
    print(2)
    X_Data=clean_dataset(X_Data.iloc[1:,:])
    print(3)
    data_2=clean_dataset(data_2.iloc[1:,:])
    print(4)

data_2=reduce_size_float(data_2)
    print(5)
    
    X_Data=pd.concat([X_Data,data_2],axis=1)
    del data_2
    print(6)

y=pd.read_csv("/content/output.csv",usecols=[9505],header=None)

y.iloc[1:,:].head()

y_data=y_labels(y.iloc[1:,:])

y_data.head()

X_Data.head()

y_data=reduce_size_int(y_data)

X_Data.shape

y_data.shape