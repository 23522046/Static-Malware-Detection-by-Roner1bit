# -*- coding: utf-8 -*-
"""Visualizations_of_data.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1t-2rPvr8BnAM_1Hgdl3UrxYPQto7_cmV
"""

from google.colab import drive
drive.mount('/content/drive')

!unzip "/content/drive/MyDrive/Untitled folder/Static/BenignCSVs.zip"

!unzip "/content/drive/MyDrive/Untitled folder/Static/Malicious-CSVs.zip"

!unzip "/content/drive/MyDrive/Untitled folder/Static/mm.zip"

import numpy as np
import pandas as pd
import csv
import matplotlib.pyplot as plt
import glob

"""**Malware**"""

location=['/content/Adware.csv','/content/Backdoor.csv','/content/Banker.csv','/content/Dropper.csv','/content/FileInfector.csv','/content/NoCategory.csv','/content/PUA.csv',"/content/Ransomware.csv","/content/Riskware.csv","/content/SMS.csv","/content/Scareware.csv","/content/Spy.csv","/content/Trojan.csv","/content/Zeroday.csv"]

Malware_Numb={}
for i in location:
  number=0
  for chunk in pd.read_csv(i,header=None,chunksize=500): 
    number=number+len(chunk.index)
  x = i.split(".", 1)
  x=x[0].split("/",2)
  Malware_Numb[x[2]]=number

Malware_Numb

Malware_Numb.keys()

# Create DataFrame  
df = pd.DataFrame(Malware_Numb.items(),columns=['Subjects','Numbers'])  
  
# Print the output.  
print(df)

Malwaretotal = sum(df['Numbers'])
print(Malwaretotal)

"""**Non Malware**"""

location_Non_malware=['/content/Ben0.csv','/content/Ben1.csv','/content/Ben2.csv','/content/Ben3.csv','/content/Ben4.csv']

Non_Malware_Numb={}

for i in location_Non_malware:
  number=0
  for benchunk in pd.read_csv(i,header=None,chunksize=500):
    number=number+len(benchunk.index)
  x = i.split(".", 1)
  x=x[0].split("/",2)  
  Non_Malware_Numb[x[2]]=number

Non_Malware_Numb

sum_Non_Malware_Numb=sum(Non_Malware_Numb.values())
sum_Non_Malware_Numb

data1 = {'Subjects': ['Total Malware Numbers Applications','Total Non Malware Numbers Applications'], 'Numbers': [Malwaretotal,sum_Non_Malware_Numb]}  
  
# Create DataFrame  
df1 = pd.DataFrame(data1)  
  
# Print the output.  
print(df1)

fig = plt.figure(figsize = (10, 5))
 
# creating the bar plot
plt.bar(df1['Subjects'], df1['Numbers'], color ='maroon',
        width = 0.4)
 
plt.xlabel("Application")
plt.ylabel("Numbers")
plt.show()

fig = plt.figure(figsize = (20, 10))
 
# creating the bar plot
plt.bar(df['Subjects'], df['Numbers'], color ='maroon',
        width = 0.9)
 
plt.xlabel("Subjects")
plt.ylabel("Numbers")
plt.title("Malware Data")
plt.show()

myexplode = [0.3, 0, 0, 0 ,0 ,0 ,0 ,0 ,0.3 ,0 ,0 ,0 ,0 ,0]
plt.pie(df['Numbers'],explode = myexplode,shadow = True, radius = 3)
plt.legend(loc ="right")
plt.legend(df['Subjects'],
          title ="Malware Names",
          loc ="center left",
          bbox_to_anchor =(1.8, 1, 0.5, 1))
plt.show()

fig = plt.figure(figsize = (5, 3))
plt.grid()
plt.plot("None Malware Application Number", sum_Non_Malware_Numb, marker="o", markersize=10, )
plt.show()

d=glob.glob('/content/mm/*')
len(d)

labeled_Hash={}
count=0
for i in d:
  if(open(i,'r').readline()==''):
    # print("hh")
    # print(count)
    count=count+1
    print(count,i)

  else:
    x= open(i,'r')
    H=x.readline()
    
  
    labeled_Hash[H.split("\t",2)[0]]=H.split("\t",2)[1].split('\n')[0].split(":")[0]+'-0' 

print("null value ",count)

len(labeled_Hash)

df_labeled_Hash=pd.DataFrame(labeled_Hash.items(),columns=['Hash','Kind'])

df_labeled_Hash.head(10)

# df_labeled_Hash.to_csv("labeled_Hash.csv")

# !cp output.csv "content/drive/My Drive/"

df_Data =  pd.DataFrame(columns=['Hash'])
for data in pd.read_csv("/content/drive/MyDrive/output.csv",header=None,chunksize=10000):
  df_Data =  pd.DataFrame({"Hash":df_Data['Hash'].append(data[1])})

df_Data

keys=list(labeled_Hash.keys())
Hash=list(df_Data['Hash'])

keys=list(map(str.lower,keys))
Hash=list(map(str.lower,Hash))

count=0
for i in Hash:
  if i in keys:
    index=keys.index(i)
    kind=labeled_Hash[keys[index]]
    kind_list=kind.split('-')
    number=int(kind_list[1])+1
    labeled_Hash[keys[index]]=kind_list[0]+'-'+str(number)
  else:
    count=count+1

labeled_Hash['others']='others-'+str(count)

df_labeled_Hash_CC=pd.DataFrame(labeled_Hash.items(),columns=['Hash','Kind'])  
df_labeled_Hash_CC.to_csv("labeled_Hash_CC.csv")

Value=list(labeled_Hash.values())

from operator import methodcaller
 df_Value=pd.DataFrame(list(map(methodcaller("split", "-"), Value)),columns=['Kind','Value'])

len(df_Value)

df_Value.sample(10)